\ File "Joystick.t"\ Access both joystick ports of the ST.\ Requires TOS in ROM (Multi-FORTH does, too).\ Uses some RAM locations in low memory, which may change on new machines.\ by Greg Guerin, at the request of Tom Roscoe\       Copyright (c) 1987 by Greg Guerin.\       Use freely, as long as copyright notice remains.{ ----------------- WHAT'S HAPPENING -  The ST intelligent keyboard (IKBD) monitors the joystick ports.  Themouse is connected to joystick port 0 (Joy0), so first we have to stopmonitoring the mouse.  We then start monitoring both joysticks, whichwill have their states presented in to byte-length RAM locations.  Asthe joysticks change state, the RAM locations change, subject to thecommunication speed of the IKBD.  This speed is usually fast enough forall but the most exacting situations.  Because the Joy0 port is used for a joystick, when we're done we haveto set the IKBD back to think it's a mouse.  If you forget to do this,the mouse won't work when the desktop comes back.- IMPORTANT WORDS -  The following words are intended for your use:        JoyBegin ( -- )             stop monitoring mouse; start joysticks        JoyEnd ( -- )               stop joysticks; resume monitoring mouse        JoyStick ( joy# -- state )  joy# = 0 or 1; state is joystick state                bits in state are:                        0 = up                        1 = down                        2 = left                        3 = right                        7 = fire-button ------- }\ There is a simple demo program to show how these words are used\       "JoyToy.t"\ Define where joystick data is foundhex E08 wconstant JoyBase  \ first of two data bytes\ IKBD: commands to start & stop joystick monitoring create KeyCommands        1214 w,   \ disable mouse; joystick event mode        0800 w,   \ set mouse RELATIVE modedecimal\ ***** The main words of interest: JoyBegin  ( -- )  \ stop monitoring mouse; start joysticks        KeyCommands     2 IKBD: Write        0 JoyBase w!  ;         \ clean out the buffer\ may require a few milliseconds for IKBD to receive and perform: JoyEnd  ( -- )  \ stop monitoring joysticks; resume mouse        KeyCommands 2+  1 IKBD: Write  ;: JoyStick  ( joy# -- state )  \ joy# is 0 or 1; state is bits (see above)        JoyBase +  c@  ;